define(["require","exports","tslib","react","classnames","spectrum_comments/thread","spectrum_comments/comment","spectrum_comments/comment_editor/comment_utils","spectrum_comments/comment_editor/comment_editor","spectrum_comments/comment_editor/components/post_bar","spectrum_comments/utils/scroll_list","spectrum_comments/experiments_provider/experiments_provider"],function(e,t,n,o,r,i,a,d,s,c,m,l){"use strict";function u(e){return e.isEmpty?null:o.createElement(c.PostBar,n.__assign({},e,{postLabel:"Post",cancelLabel:"Cancel",disableCancelButton:e.isEmpty}))}Object.defineProperty(t,"__esModule",{value:!0});var p=(function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.state={content:d.createEmptyContent(),editedComment:void 0},t.onThreadActivated=function(e){return function(){t.props.actionsAdapter.onThreadActivated(e)}},t.onStartEdit=function(e){t.setState({editedComment:e})},t.onEndEdit=function(){t.setState({editedComment:void 0})},t.handleClick=function(e){e.currentTarget===e.target&&t.props.actionsAdapter.onAllThreadsDeactivated()},t.onThreadReplyCancel=function(){t.onTopEditorCancel(),t.props.actionsAdapter.onAllThreadsDeactivated()},t.onTopEditorCancel=function(){t.setState({content:d.createEmptyContent(),editedComment:void 0})},t.onEditorFocus=function(){t.props.actionsAdapter.onAllThreadsDeactivated(),t.props.actionsAdapter.onEditorFocused()},t.promptBeforeCloseHandler=function(e){return t.allThreadsComplete?void 0:(e.returnValue="",e.preventDefault(),"")},t}return n.__extends(t,e),t.prototype.componentDidMount=function(){window.addEventListener("beforeunload",this.promptBeforeCloseHandler)},t.prototype.componentWillUnmount=function(){window.removeEventListener("beforeunload",this.promptBeforeCloseHandler)},Object.defineProperty(t.prototype,"allThreadsComplete",{get:function(){return this.props.threads.every(function(e){return void 0===e.pending})},enumerable:!0,configurable:!0}),t.prototype.render=function(){var e=this,t=this.props,d=t.actionsAdapter,c=d.onCommentDeleted,p=d.onCommentEdited,h=d.onClickTimeCode,C=d.onEditorFocused,f=d.onMentionsQueryUpdated,E=d.onThreadCreated,v=d.onThreadMarkedAsRead,T=d.onThreadMarkedAsUnread,_=d.onThreadRepliedTo,y=d.onThreadResolved,A=d.onThreadUnresolved,b=t.className,M=void 0===b?"":b,k=t.commentComponent,g=void 0===k?function(e){return o.createElement(a.Comment,n.__assign({},e))}:k,S=t.editorComponent,D=void 0===S?function(e){return o.createElement(s.CommentEditor,n.__assign({},e))}:S,R=t.enabled,U=t.user,P=t.mentionsMatches,F=t.activeThreadID,x=t.isMobile,B=t.threads,L=r(M,{"sc-comment-stream":!0,"sc-comment-stream-enabled":R,"sc-comment-stream-all-threads-complete":this.allThreadsComplete}),N=null;U&&(N=D({author:U,className:"sc-comment-stream-editor",content:this.state.content,placeholder:"Write a comment",postSignalComponent:u,onCancel:this.onTopEditorCancel,onPost:E,mentionsMatches:P,onMentionsQueryUpdated:f,onFocus:this.onEditorFocus}));var w=B.map(function(t){return o.createElement(i.Thread,{key:t.id,actions:{onClickTimeCode:h,onReply:function(e){return _(t.id,e)},onMarkAsRead:function(){return v(t.id)},onMarkAsUnread:function(){return T(t.id)},onResolve:function(){return y(t.id)},onUnresolve:function(){return A(t.id)},onEditorFocused:function(){return C(t.id)},onCommentDeleted:function(e){return c(e,t.id)},onCommentEdited:function(e,n){return p(e,n,t.id)},onMentionsQueryUpdated:f},active:t.id===F,commentComponent:g,editedComment:e.state.editedComment,onActivated:e.onThreadActivated(t),onCancel:e.onThreadReplyCancel,onStartEdit:e.onStartEdit,onEndEdit:e.onEndEdit,isMobile:x,thread:t,user:U,mentionsMatches:P})});return o.createElement(l.ExperimentsProvider,{className:L,readOnlyCommentEditor:this.props.readonlyEditor||!1},!x&&N,o.createElement(m.ScrollList,{className:"sc-comment-stream-threads",onClick:this.handleClick},w))},t})(o.PureComponent);t.CommentStream=p,i.Thread.displayName="Thread"});
//# sourceMappingURL=comment_stream.min.js-vflq2H72G.map