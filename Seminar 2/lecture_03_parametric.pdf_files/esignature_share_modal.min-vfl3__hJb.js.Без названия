define(["require","exports","tslib","esignature_prototype/api","esignature_prototype/components/esignature_utility_modals","esignature_prototype/components/esignature_share_modal/share_modal_error_message","esignature_prototype/components/esignature_share_modal/share_modal_footer","esignature_prototype/components/esignature_share_modal/share_modal_main_section","external/lodash","external/react","modules/clean/flux/store_listener","modules/clean/react/css","modules/clean/react/modal","modules/clean/sharing/ui_util","modules/clean/sharing/stores/sharing_info","modules/clean/sharing/views/share_modal_contacts_section","modules/clean/sharing/views/share_modal_header_section","modules/clean/viewer","spectrum/modal"],function(e,n,t,a,o,r,s,i,c,l,d,u,m,g,p,h,_,S,f){"use strict";function M(e){var n=S.Viewer.get_viewer();return n.personal_email===e||n.work_email===e}Object.defineProperty(n,"__esModule",{value:!0});var E=function(e){var n=e.actionHandler.getSharingInfo(),a={actionHandler:e.actionHandler,contactsError:n.contactsError(),contentInfo:n.contentInfo(),initialRecipientTokens:n.initialRecipientTokens(),isTokenizerEmpty:n.isTokenizerEmpty(),recipientMessage:n.recipientMessage(),uiMode:n.uiMode()};return t.__assign({},n.getInitialProps(),a)},C=(function(e){function n(){var n=null!==e&&e.apply(this,arguments)||this;return n.setContactsSectionRef=function(e){n.contactsSection=e},n.handleSendButtonClick=function(){var e=n.props,t=e.actionHandler,r=e.contactsError,s=e.createRequestArg,i=e.recipientMessage,d=e.sendForSignature,u=e.user,p=n.contactsSection.getContacts();t.recipientsChange(p).then(function(){if(r.level!==g.ContactsErrorLevel.Error&&p.length>0&&p[0].email){if(m.Modal.close(),M(p[0].email))return void m.Modal.showInstance(l.createElement(o.EsignatureCannotSendToYourselfModal,null));var e=c.clone(s);e.recipient_emails=[p[0].email],e.recipient_message=i,a.sendSignatureRequest(e,u.id).then(function(e){d(),m.Modal.showInstance(l.createElement(o.EsignatureSentForSignatureModal,{email:p[0].email}))}).catch(function(e){return m.Modal.showInstance(l.createElement(o.EsignatureSendForSignatureFailedModal,null))})}})},n}return t.__extends(n,e),n.prototype.render=function(){var e=this.props,n=e.actionHandler,t=e.contentInfo,a=e.user,o=e.initialRecipientTokens,d=e.contactsError,u=e.recipientMessage,g=e.uiMode,p=e.isTokenizerEmpty;return l.createElement(f.Modal,{ariaLabel:"Esignature Sharing Modal",className:"scl-share-modal esignature-share-modal",bodyClassName:"scl-share-modal-content",overlayClassName:"esignature-modal-overlay",displayCloseButton:!1,open:!0,width:540,overlayClickClose:!0,onRequestClose:m.Modal.close},l.createElement(_.ShareModalHeaderSection,{actionHandler:n,contentInfo:t,canEdit:!0,isTeamSharedFolder:!1,isMetadataLoaded:!0,onModalCloseClick:m.Modal.close,onSettingsButtonClick:c.noop,onContentNameInputChange:c.noop,onContentNameInputKeyUp:c.noop,sharingInfo:n.getSharingInfo(),showPassFileSettings:!1,user:a,isSendingForSignature:!0}),l.createElement(h.ShareModalContactsSection,{ref:this.setContactsSectionRef,actionHandler:n,canInviteEditor:!1,canInviteViewer:!1,contentInfo:t,initialAccessLevel:"signer",initialTypeaheadTokens:o,isFolderInsideTeamFolderTree:!1,isInContentManager:!1,isTeamSharedFolder:!1,memberCountWithRecipients:0,typeaheadPlaceholder:"Email or name",user:a,isSendingForSignature:!0}),l.createElement(r.ShareModalErrorMessage,{error:d}),l.createElement(i.ShareModalMainSection,{actionHandler:n,mode:g,recipientMessage:u}),l.createElement(s.ShareModalFooter,{mode:g,contentInfo:t,contactsError:d,isTokenizerEmpty:p,onSendButtonClick:this.handleSendButtonClick}))},n})(l.Component),y=d.listenToStores(C,{sharingInfoStore:p.sharingInfoStore},E),v=u(y,["/static/js/spectrum-sharing/index.web-vflKsgd8x.css","/static/css/esignature_prototype/modals-vflxrQfuw.css","/static/css/react/contacts_tokenizer-vflQsfYaG.css","/static/css/scooter/scooter-scoped-vflrM1SRf.css","/static/css/sharing/share_modal-vfl3OhnPJ.css","/static/css/modal-vflI292PU.css"]);n.EsignatureShareModal=v});
//# sourceMappingURL=esignature_share_modal.min.js-vfl_OENnI.map